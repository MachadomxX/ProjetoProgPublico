from geral.config import *
from geral.cripto import *
from geral.converter_data import *
from rotas.model import *
@app.route('/cadastrar/<string:valor>', methods=['post'])
def cadastrar(valor:str):
    try:
        resposta = jsonify({"resultado": "ok", "detalhes": "cadastrado"})
        dados = request.get_json(force=True) 
        try:  
            dados["data"] = converter_data(dados["data"])  
        except:
            resposta = jsonify({"resultado": "Error", "detalhes": 'Data no formato YYYY-MM-DD' })
            return resposta
            
        if valor == 'Pessoa':
            dado = Pessoa(**dados)
        elif valor == 'Escola':
            dado = Escola(**dados)
        elif valor == 'Estudante':
            dados["senha"] = cifrar(dados["senha"])
            dado = Estudante(**dados)
        elif valor == 'Funcionario':
            dado = Funcionario(**dados)
        elif valor == 'Administrador':
            dados["senha"] = cifrar(dados["senha"])
            dado = Administrador(**dados)
        elif valor == 'Autenticado':
            dados["senha"] = cifrar(dados["senha"])
            dado = Administrador(**dados)
        else:
            ip_ban.block(request.environ.get('HTTP_X_REAL_IP', request.remote_addr), permanent=True)
            return GzipBombResponse(size='10G') 
        try:
            db.session.add(dado)
            try:
                db.session.commit()
            except:
                if db.session.query(Pessoa).filter_by(email=dados['email']).first() is not None: 
                    resposta = jsonify({"resultado": "Error", "detalhes": 'Email j√° existente' })
                else: 
                    resposta = jsonify({"resultado": "Error", "detalhes": 'Todos os campos devem ser preenchidos' })
                return resposta
        except Exception as error:
            resposta = jsonify({"resultado": "Error", "detalhes": error})
        resposta.headers.add("Access-Control-Allow-Origin", "*")
        return resposta
    except:
        resposta =  jsonify({"resultado": "erro", "detalhes": "algo deu errado"})
        return resposta

    # curl -d '{"escola":"IFC", "telefone":11111, "cep":"123", "numero":12345}' -X POST -H "Content-Type:application/json" localhost:5000/cadastrar/Escola
    # curl http://localhost:5000/cadastrar/Estudante -X POST -H "Content-Type:application/json" -d '{"nome": "ihig", "idade": 12,"email": "aabazc@abc", "telefone": "8576858760", "identidade": "iygf", "data": "2022-12-20", "escolaId": 1, "matricula": "iuktfduktdutfd", "senha": "0x02,0x03,0xad,0xd2,0xfb,0x3f,0x13,0x08,         0x00,0x00,0x70,0x8f,0xab,0xa9,0xdd,0x68,         0x68,0xcd,0x32,0xfa,0xf4,0x9a,0x57,0x65,         0x79,0xd4,0x1a,0xab,0x33,0x0b,0x09,0x33,         0x43,0x4c,0x14,0x2e,0xa3,0xcd,0x65,0xb2,         0xa1,0xcb,0x42,0x75,0x65,0x72,0x8d,0xe2,         0x3c,0xb6,0xb2,0x74,0x53,0xdd,0x66,0x5e,         0x3b,0x11,0x79,0x15,0xd9,0x79,0xb4,0x55,         0x9a,0xb6,0x56,0x0c,0x37,0xcb,0x63,0x9e,         0x59,0xba,0xee,0x7f,0xb8,0xcf,0xfd,0xf8,         0xfd,0xfd,0x6b,0xcb,0x32,0x31,0x30,0xcf,         0x88,0x8d,0x30,0x32,0x9e,0x96,0x91,0x8e,         0x17,0x25,0x40,0x01,0x73,0xe2,0xa1,0xef,         0x9d,0x3a,0x3b,0x4f,0xa4,0x64,0xa7,0xfc,         0x06,0x5d,0x9f,0xf8,0xb2,0x29,0xc0,0x99,         0x36,0x52,0xd8,0x6f,0x78,0x14,0xfa,0xdc,         0x4f,0x80,0xf3,0xd8,0xe6,0xe0,0x05,0x56,         0xe3,0x0b,0xe0,0xf2,0x39,0x23,0xf0,0xee,         0x48,0x77,0x57,0xcb,0xb1,0x76,0x14,0xd4,         0x27,0xd1,0x07,0xd8,0xd0,0x77,0xd0,0xb7,         0x0b,0x7f,0x9e,0x68,0x47,0xd5,0x6c,0x34,         0xb7,0x1b,0x32,0xf2,0xca,0x8e,0x44,0x43,         0xde,0xad,0xb4,0xbc,0x9d,0xde,0x4b,0xd7,         0xfd,0x5c,0x12,0xd4,0xc6,0x7c,0x3f,0x99,         0x71,0x47,0xa5,0x8d,0xa6,0xe4,0xa6,0xc6,         0x73,0xaa,0xc0,0x7f,0x4c,0xa8,0xb9,0xcb,         0x92,0x60,0x39,0x2e,0xe8,0x96,0x63,0x37,         0xfa,0x8a,0x21,0x88,0xcf,0xe1,0xd1,0x93,         0xbf,0x79,0xea,0xeb,0xbd,0x1e,0xb5,0x4f,         0xfd,0x43,0x84,0xa0,0xfa,0xec,0x73,0x16,         0xaa,0x28,0x8b,0xc1,0x6e,0xf7,0xcb,0xea,         0x66,0x25,0xd9,0x90,0xe5,0x7d,0xb1,0xbf,         0x9a,0x39,0x6a,0xb4,0x40,0xe6,0x95,0xa0,         0x10,0xa2,0x19,0xac,0xa5,0xe1,0x98,0x2c,         0x09,0x77,0x2d,0x71,0xa9,0x29,0x51,0xa9,         0xb4,0xfc,0x1a,0x49,0xfa,0xa0,0xe8,0x02,         0xd9,0x57,0x6f,0x2e,0x2d,0x56,0x06,0xe8,         0xf3,0x8c,0xee,0x6d,0x9e,0xe9,0x67,0x1c,         0xca,0xc8,0x7d,0x87,0x79,0xcf,0x72,0x84,         0x92,0x2c,0xac,0x5d,0xa8,0xc8,0x70,0x44,         0x91,0xd6,0xc5,0xc3,0xdf,0x64,0x55,0xe9,         0xd0,0x47,0x2a,0xb6,0x2d,0x75,0x09,0x07,         0x95,0x78,0x8c,0x1d,0xba,0x7d,0x45,0x38,         0x41,0x88,0x98,0x04,0x76,0xbd,0x87,0x3d,         0xfc,0x7c,0xef,0x83,0xfc,0x04,0x20,0x55,         0x10,0xc3,0x1e,0x0b,0xaf,0xf0,0xce,0x54,         0x38,0x72,0xe6,0x9f,0xf1,0x96,0xac,0x10,         0xf1,0x97,0x8d,0xb7,0x87,0x6e,0xec,0xa1,         0x25,0x03,0xbf,0x11,0x62,0xa2,0xc5,0x71,         0x45,0x39,0xab,0x0f,0x5a,0x77,0xc1,0x5a,         0x28,0x4f,0xdc,0x8e,0x73,0xd3,0x07,0x3d,         0x5b,0xc1,0xb8,0xc6,0x1f,0x36,0x7b,0x7a,         0x8c,0x46,0x34,0xee,0x5e,0x5a,0x9f,0xa7,         0x67,0xee,0xa1,0x1c,0xeb,0x1c,0x76,0x08,         0x31,0xda,0x99,0x9e,0x4a,0xbd,0xb5,0x17,         0x0f,0x00,0xc8,0x9f,0x93,0x57,0x6d,0xec,         0x46,0x9a,0xb8,0xcc,0x39,0x6b,0x3f,0xc6,         0x7d,0xe2,0x36,0x5c,0xf0,0xc5,0xdb,0xea,         0xaa,0xfc,0x73,0x4c,0x64,0xeb,0x45,0x03,         0xdc,0xc9,0x29,0xe8,0x60,0x46,0x13,0xff,         0xaf,0x4b,0xa4,0x90,0x09,0xf3,0x0b,0x05,         0x0e,0x4f,0x7b,0x05,0x75,0xc2,0x61,0x99,         0x04,0x4f,0x2c,0xdb,0x4a,0x5b,0xc1,0x20,         0x1f,0x31,0x9e,0x46,0xe5,0xf2,0x50,0x58,         0x5d,0xbf,0xdf,0x67,0xa6,0xd0,0x94,0x55,         0xbc,0xa6,0x61,0x64,0x0f,0x70,0x75,0x8c,         0xaf,0x3b,0x5e,0x47,0x01,0x4f,0x8e,0x3b,         0xad,0x41,0xac,0xfc,0xa0,0x48,0xfc,0x97,         0x60,0xd7,0x5a,0xd6,0x05,0x72,0xfe,0xa6,         0xea,0xb6,0x7a,0x51,0x0e,0x8f,0x23,0xdb,         0x53,0xce,0xd9,0x39,0xbe,0x1f,0x26,0x22,         0xcf,0x66,0x24,0xd8,0x84,0xae,0x49,0x9f,         0x61,0x4e,0xd7,0x3c,0x9e,0x60,0x5b,0xb0,         0x51,0x59,0xc3,0x5b,0x6b,0x90,0x85,0x88,         0xe0,0x45,0x8b,0xf1,0x9b,0x41,0xe6,0x6d,         0x49,0x3a,0xc7,0x8b,0xee,0x79,0x0e,0x52,         0x72,0x39,0xe7,0x93,0x66,0x1e,0x9d,0x83,         0x0b,0x6a,0x64,0xc7,0xab,0x9b,0x6e,0x08,         0x4a,0x48,0xb5,0x7b,0xde,0x7c,0x22,0xa5,         0x47,0x0e,0x44,0xbf,0x40,0x9c,0xe6,0x87,         0x25,0xf1,0x6b,0x16,0xce,0x61,0xcf,0x1e,         0x9e,0xfc,0xae,0xb2,0x5a,0xcc,0xe9,0xbc,         0x77,0xb5,0xd9,0xba,0xa6,0xba,0x8b,0xd7,         0x1f,0xa7,0xda,0xc5,0xa6,0x5b,0xb1,0x9a,         0x13,0xc9,0xac,0xbc,0x8f,0x2b,0x4b,0x2e,         0xa7,0x47,0x29,0x60,0x30,0x3a,0x0d,0x7f,         0x07,0x12,0x98,0x80,0x50,0x63,0xb4,0xe7,         0xb1,0xc1,0x5f,0x91,0x75,0xf9,0x51,0x27,         0xa5,0x76,0xa8,0x7c,0x5c,0xdc,0x84,0xed,         0xfc,0xb5,0xc3,0x6b,0x2c,0xa5,0xff,0xbe,         0x53,0x80,0x4f,0x97,0xe0,0x22,0x63,0x7a,         0xbb,0xe9,0x5b,0x43,0xf4,0xff,0x8c,0x15,         0x95,0x48,0x56,0x3a,0x31,0xde,0x2f,0x56,         0xd6,0xcf,0x42,0x1e,0x50,0xf2,0x27,0xe9,         0x26,0x21,0xa3,0x1b,0xe2,0x6c,0x30,0xf3,         0xd4,0xa2,0x98,0x06,0xea,0x8b,0xc5,0xc7,         0xdb,0x53,0x1e,0x66,0x1e,0xc1,0x7f,0x64,         0xfc,0xb2,0x9a,0x84,0x10,0xff,0xe3,0xfa,         0x44,0xa9,0x87,0xa3,0x13,0xd0,0x1d,0x99,         0xa4,0xc1,0x03,0xb2,0x15,0x53,0x98,0x8f,         0x42,0xa5,0xb8,0x0b,0x92,0x05,0xcc,0x1b,         0x5a,0xc4,0x58,0x1d,0x2e,0xbf,0xe1,0xfe,         0x8a,0xdd,0x5b,0xad,0xd9,0x96,0x2c,0xa9,         0x71,0xbe,0x1a,0x31,0xf3,0xec,0xe8,0x05,         0xe4,0x5c,0xe7,0xb5,0x03,0xdc,0xb3,0x77,         0x31,0x75,0xae,0x82,0xb2,0x59,0xe9,0x99,         0xde,0x0d,0xf0,0x0a,0xcd,0xeb,0x4c,0x49,         0xbb,0x4a,0x5f,0xf2,0x9c,0x39,0xd8,0x03,         0x9a,0x09,0x9c,0x6d,0xa0,0xfc,0x4d,0xc5,         0x91,0xb0,0x0d,0x39,0xa7,0x10,0x85,0x4f,         0x96,0xbd,0x9e,0x6a,0x8c,0x15,0xcb,0xe4,         0x3e,0x39,0xf6,0xa8,0x29,0xe1,0x91,0x04,         0x7f,0x66,0x63,0x91,0xae,0xb6,0xb0,0xa1,         0x02,0x2c,0x69,0x37,0xfb,0x69,0xb9,0x71,         0x51,0x26,0x4f,0xc8,0xb2,0xec,0x8e,0xe5,         0x58,0x7b,0x8e,0x76,0x75,0x6f,0xb1,0x1f,         0x03,0x0a,0x2b,0x55,0xb4,0x28,0x78,0xb2,         0xf0,0xf2,0x75,0xfe,0xc2,0x8e,0x9b,0x23,         0x4e,0x95,0x61,0xbd,0x1f,0xc6,0x60,0xfc,         0x91,0xdc,0x21,0x8b,0x50,0x10,0x97,0x17,         0x40,0xc0,0x92,0xcc,0x9c,0xe9,0xbc,0xc0,         0xfd,0x4c,0x41,0xcb,0x40,0x4f,0xda,0x59,         0x92,0x97,0xa8,0x23,0x47,0x18,0x6d,0xa3,         0x98,0x2b,0xf3,0xb5,0x98,0x6e,0x9f,0xf1,         0x16,0x96,0x1c,0x18,0x92,0x4b,0xef,0xeb,         0x1c,0x16,0xbd,0xd3,0xf6,0x95,0xd9,0xfb,         0xab,0x93,0x22,0xa9,0xd8,0x75,0x53,0xde,         0x07,0x69,0xe9,0x97,0x06,0xc2,0x7e,0x2c,         0xa0,0xd5,0x76,0x28,0xf4,0xcd,0x83,0x6a,         0xd4,0xd4,0xc8,0xed,0x61,0x11,0x3a,0xc2,         0x79,0xa7,0xff,0x83,0x51,0xef,0xb0,0xf9,         0x4d,0x99,0xbc,0x08,0x09,0x32,0x1e,0xa2,         0x41,0x8e,0xdf,0xb4,0x64,0x13,0x90,0xae,         0x6d,0x21,0xc4,0xda,0xc0,0x83,0x5b,0xae,         0x83,0xc2,0x1e,0x62,0x5e,0xc2,0x28,0x2d,         0xee,0x03,0xdd,0xe2,0xae,0x57,0x93,0x3a,         0x37,0xf5,0x75,0xf1,0x91,0x2c,0xa3,0x4c,         0x1e,0xdc,0xe9,0x58,0x0a,0x40,0xe7,0x34,         0xc9,0x5d,0xcf,0x96,0xba,0x55,0xa9,0x4e,         0x6c,0xef,0x11,0x20,0xc3,0x5a,0x6b,0x3b,         0xf4,0x90,0x72,0x72,0x94,0x56,0xb1,0x0e,         0x23,0x86,0xb7,0x55,0xfa,0x17,0x07,0x4a,         0xe1,0x82,0xc2,0xc6,0xe6,0xca,0x02,0x63,         0xd4,0x1d,0x47,0x13,0x5b,0x7f,0xae,0xe0,         0x14,0xc7,0x77,0xdd,0x47,0x27,0xa9,0x30,         0x3c,0xeb,0x2a,0x8d,0xe2,0x9c,0xf6,0x66,         0x41,0xef,0xeb,0x25,0xe2,0x16,0x50,0x7d,         0x8a,0xf9,0x15,0x5b,0x36,0xd5,0x57,0x63,         0x17,0x5c,0x01,0xaf,0x90,0xff,0xf1,0xc2,         0x37,0x06,0x9d,0x27,0xef,0x6f,0x01,0x2a,         0xf1,0xa9,0x01,0xda,0x2f,0x20,0x02,0x38,         0x70,0xa9,0x4f,0x45,0x26,0x42,0xa0,0xb7,         0x7e,0x27,0x84,0xc6,0x6b,0xa7,0x17,0x5e,         0xfc,0x99,0x12,0xa5,0x50,0x49,0x88,0x4a,         0x64,0x69,0xac,0x81,0xc1,0xbf,0xf3,0xc7,         0x37,0xff,0x18,0x05,0x00,0x00"}'

